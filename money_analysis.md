# Сравнительный анализ LLM для корпоративной RAG системы на русском языке

## Цель исследования:
Разработать и проанализировать стоимость ресурсов/внешних LLM для RAG-системы для обработки текстовых запросов сотрудников на основе статей из Wikipedia. 
Заказчик — компания с отделом из 25 человек, где каждый сотрудник ежедневно работает с 3–5 статьями, задавая до 30–40 вопросов по каждой статье.

## Ключевые задачи:

* Выбор оптимальных LLM (локальных и облачных) с учетом:
    * Ограничений заказчика (1 GPU).
    * Поддержки кириллицы (русский язык в датасете).
    * Стоимость эксплуатации.

* Расчет времени обработки запросов для оценки реализуемости MVP.
* Рекомендации по оптимизации (уменьшение контекста, кэширование, суммаризация).

## Ожидаемые результаты:

* Сравнительная таблица моделей по:

    * Стоимости в день.
    * Скорости обработки (на 1 запрос и весь объем).
    * Качеству работы с русским текстом.

* Вывод о целесообразности локального или облачного решения.


## 1. Выбор моделей для анализа
**Локальные модели** (развертывание на 1 GPU заказчика):

Локальные модели требуют наличия в штате MLOps инженера на поддержку, поэтому на этапе MVP этот вариант рассматривать не будем. 

**Облачные API**:
 
* YandexGPT Lite
* Chat-gpt4o


## 2. Параметры для расчета

**Количество сотрудников:** 25

**Статей в день на сотрудника:** 4 (среднее между 3-5)

**Запросов на статью:** 35 (среднее между 30-40)

**Количество текстов добавляемое в RAG**: 3

## 3. Расчет нагрузки в день
**Всего запросов в день:** 25 сотрудников × 4 статьи × 35 запросов = 3500 запросов/день

**Количество символов в день в запросах сотрудников** 3500 × x 100 символов  = 1 050 000 символов/день

**Количество символов, которые отправляем в модель** 3 чанка х 2000 символов x 3500 запросов = 21 000 000 символов/день  

**Оценка для текстов на русском:** 1 токен ≈ 4 символов

**Количество токенов в запросе:** 21 000 000 / 4 = 5 250 000 токенов/день

**Количество токенов в ответе** 150 токенов * 3500 запросов = 525 000 токенов/день

**Количество токенов всего:** 5 775 000 токенов/день

### Цена токенов для ChatGpt4o

**Ввод** 0.03$ за 1000 токенов
**Выход** 0.06$ за 1000 токенов

### Цена токенов для YandexGPT Lite

**Ввод** 0.2₽ за 1000 токенов
**Выход** 0.2₽ за 1000 токенов

## 4. Стоимость для облачных API
| Модель           | Стоимость вход/день | Стоимость выход/день | Скорость обработки запроса | Поддержка русского |
|:----------------|--------------:|----------------:|--------------------:|----------------:|
| YandexGPT Lite | 1050₽ (~13$)  | 105₽ (~1.3$) | 5-10 секунд в среднем, до минуты для сложных запросов | есть |
| Chat-gpt4o | 157,5$ | 31,5$ | 5-10 секунд в среднем, до минуты для сложных запросов | есть |

## Выводы: 

#### Локальные модели:

**Проблема:** Требуют наличия в штате MLOps специалиста, который сможет 
**Решение:** Если проект выйдет из MVP в эксплуатацию - стоит рассчитать, насколько выгодно будет нанимать человека в штат и оценить, через сколько это начнет окупать себя. 

#### Облачные API:

##### Сравнение Chat-gpt4o и YandexGPT Lite
###### YandexGPT Lite
**Преимущества:**

* Экономичность: Существенно меньшая стоимость (1050₽ + 105₽ ≈ 1155₽ / день или ~14.3$/день).

* Поддержка русского языка: Подходит для обработки запросов на русском языке.

* Скорость: Сравнимая с ChatGPT4o, среднее время ответа составляет 5-10 секунд.

**Недостатки:**

* Возможны ограничения в точности и глубине анализа по сравнению с GPT-4o, особенно для сложных задач.

###### ChatGPT4o
**Преимущества:**

* Высокая точность: Модель GPT-4 известна своей глубокой проработкой текстов и универсальностью.
* Поддержка русского языка: Работает с запросами высокой сложности и контекста.
* Масштабируемость: Подходит для работы с большими объёмами данных и сложными запросами.

**Недостатки:** 
* Высокая стоимость
* Требуется использование vpn

##### Итог: 
Выбирайте YandexGPT Lite, если основной акцент на экономичности и запросы являются типовыми или средней сложности.

Выбирайте ChatGPT4o, если важны высокая точность, универсальность и возможность обработки сложных задач.

